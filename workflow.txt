read config.xml

"set application_name = 'Palette Insight - Talend " + jobName  +" : "+ jobVersion + " ' "  (after every open connection)

log job version
get data model version: "select first_value(version_number) over (order by id desc) as model_version from " + context.Target_Schema + ".db_version_meta v limit 1"

PI_Report_p_threadinfo_new
	"select " + context.Target_Schema +".manage_partitions('" + context.Target_Schema +"', 'p_threadinfo')"
	"select "+ context.Target_Schema + ".load_p_threadinfo('"+ context.Target_Schema + "', '"+context.load_type+"') "

Report_truncate_s_serverlogs
	"truncate table "+ context.Target_Schema+".s_serverlogs;"
	
Report_load_s_serverlogs_rest
	"select "+ context.Target_Schema + ".load_s_serverlogs_rest('"+ context.Target_Schema + "') "
	
Report_load_s_serverlogs_vizql
	"select "+ context.Target_Schema + ".load_s_serverlogs_vizql('"+ context.Target_Schema + "') "

Report_load_s_serverlogs_dataserver
	"select "+ context.Target_Schema + ".load_s_serverlogs_dataserver('"+ context.Target_Schema + "') "

Report_load_s_serverlogs_tabproto
	"select "+ context.Target_Schema + ".load_s_serverlogs_tabproto('"+ context.Target_Schema + "') "

Report_load_s_serverlogs_tdeserver
	"select "+ context.Target_Schema + ".load_s_serverlogs_tdeserver('"+ context.Target_Schema + "') "

Report_load_p_serverlogs
	"select " + context.Target_Schema +".manage_partitions('" + context.Target_Schema +"', 'p_serverlogs')"
	"select "+ context.Target_Schema + ".delete_recent_records_from_p_serverlogs('"+ context.Target_Schema + "')"
	"select "+ context.Target_Schema + ".insert_p_serverlogs_from_s_serverlogs('"+ context.Target_Schema + "')"

PI_Report_p_http_requests_new
	"truncate table "+ context.Target_Schema+".p_http_requests;"
	"select "+ context.Target_Schema + ".load_p_http_requests('"+ context.Target_Schema + "' ) "

PI_Report_s_http_requests_with_workbooks_new
	"truncate table "+ context.Target_Schema+".s_http_requests_with_workbooks;"
	"select  "+ context.Target_Schema + ".load_s_http_requests_with_workbooks ('"+ context.Target_Schema + "' ) "

PI_Report_p_background_jobs
	"truncate table "+ context.Target_Schema+".p_background_jobs;"
	"select "+ context.Target_Schema + ".load_p_background_jobs('"+ context.Target_Schema + "' ) "
	
Report_truncate_s_serverlogs_compressed
	"truncate table "+ context.Target_Schema+".s_serverlogs_compressed;"

Report_load_s_serverlogs_vizql_compressed
	"select "+ context.Target_Schema + ".load_s_serverlogs_vizql_compressed('"+ context.Target_Schema + "') "

Report_load_s_serverlogs_tabproto_compressed
	"select "+ context.Target_Schema + ".load_s_serverlogs_tabproto_compressed('"+ context.Target_Schema + "') "

Report_load_s_serverlogs_dataserver_compressed
	"select "+ context.Target_Schema + ".load_s_serverlogs_dataserver_compressed('"+ context.Target_Schema + "') "
	
Report_tuncate_s_cpu_usage
	"truncate table "+ context.Target_Schema+".s_cpu_usage;"

Report_load_s_cpu_usage_vizql
	"select "+ context.Target_Schema + ".load_s_cpu_usage_vizql('"+ context.Target_Schema + "') "

Report_load_s_cpu_usage_dataserver
	"select "+ context.Target_Schema + ".load_s_cpu_usage_dataserver('"+ context.Target_Schema + "') "

Report_load_s_cpu_usage_tabproto
	"select "+ context.Target_Schema + ".load_s_cpu_usage_tabproto('"+ context.Target_Schema + "') "

Report_load_s_cpu_usage_rest
	"select "+ context.Target_Schema + ".load_s_cpu_usage_rest('"+ context.Target_Schema + "') "

Report_load_s_cpu_usage_tdeserver
	"select "+ context.Target_Schema + ".load_s_cpu_usage_tdeserver('"+ context.Target_Schema + "') "
	
Report_load_p_cpu_usage
		"select " + context.Target_Schema +".manage_partitions('" + context.Target_Schema +"', 'p_cpu_usage')"
		"select "+ context.Target_Schema + ".load_from_stage_to_dwh('"+ context.Target_Schema + "', 'p_cpu_usage')"

PI_Report_p_cpu_usage_report_new		
	"truncate table "+ context.Target_Schema+".s_cpu_usage_report;"
	"select "+ context.Target_Schema + ".load_s_cpu_usage_report('"+ context.Target_Schema + "' ) "
	"select " + context.Target_Schema +".manage_partitions('" + context.Target_Schema +"', 'p_cpu_usage_report')"
	"select "+ context.Target_Schema + ".load_from_stage_to_dwh('"+ context.Target_Schema + "', 'p_cpu_usage_report')"
	
Report_load_p_cpu_usage_agg_report
	"truncate table "+ context.Target_Schema+".s_cpu_usage_agg_report;"
	"select "+ context.Target_Schema + ".load_s_cpu_usage_agg_report('"+ context.Target_Schema + "') "
	"select " + context.Target_Schema +".manage_partitions('" + context.Target_Schema +"', 'p_cpu_usage_agg_report')"
	"select "+ context.Target_Schema + ".load_from_stage_to_dwh('"+ context.Target_Schema + "', 'p_cpu_usage_agg_report')"

Report_load_p_interactor_session
	"truncate table "+ context.Target_Schema+".s_interactor_session;"
	"select "+ context.Target_Schema + ".load_s_interactor_session('"+ context.Target_Schema + "') "
	"select " + context.Target_Schema +".manage_partitions('" + context.Target_Schema +"', 'p_interactor_session')"
	"select "+ context.Target_Schema + ".load_from_stage_to_dwh('"+ context.Target_Schema + "', 'p_interactor_session')"
	"select "+ context.Target_Schema + ".handle_utc_midnight_interactor_sess('"+ context.Target_Schema + "')"
	
Report_load_p_process_class_agg_report
	"truncate table "+ context.Target_Schema+".s_process_class_agg_report;"
	"select "+ context.Target_Schema + ".load_s_process_class_agg_report('"+ context.Target_Schema + "') "
	"select " + context.Target_Schema +".manage_partitions('" + context.Target_Schema +"', 'p_process_class_agg_report')"
	"select "+ context.Target_Schema + ".load_from_stage_to_dwh('"+ context.Target_Schema + "', 'p_process_class_agg_report')"
	
Report_load_p_serverlogs_bootstrap_rpt
	"truncate table "+ context.Target_Schema+".s_serverlogs_bootstrap_rpt;"
	"select "+ context.Target_Schema + ".load_s_serverlogs_bootstrap_rpt('"+ context.Target_Schema + "') "
	"select " + context.Target_Schema +".manage_partitions('" + context.Target_Schema +"', 'p_serverlogs_bootstrap_rpt')"
	"select "+ context.Target_Schema + ".load_from_stage_to_dwh('"+ context.Target_Schema + "', 'p_serverlogs_bootstrap_rpt')"
	
Report_load_p_cpu_usage_bootstrap_rpt
	"truncate table "+ context.Target_Schema+".s_cpu_usage_bootstrap_rpt;"
	"select "+ context.Target_Schema + ".load_s_cpu_usage_bootstrap_rpt('"+ context.Target_Schema + "') "
	"select " + context.Target_Schema +".manage_partitions('" + context.Target_Schema +"', 'p_cpu_usage_bootstrap_rpt')"
	"select "+ context.Target_Schema + ".load_from_stage_to_dwh('"+ context.Target_Schema + "', 'p_cpu_usage_bootstrap_rpt')"
	